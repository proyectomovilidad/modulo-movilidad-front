<body>
<header>
  <section id="title">

    <div id="titulo">
      Sistema de relaciones exteriores
      <br />
      Módulo de movilidad académica - Convocatoria
    </div>

  </section>
</header>

<section id="body" *ngIf="roles.includes(rol)">

  <div id="name">
    <h3> Crear </h3>
  </div>

  <br />

  <form [formGroup]="formularioCrearConvocatoria" class="row justify-content-center form">



    <div class="form-group col-md-2">
      <label class="label ">Nombre convocatoria *</label>
    </div>

    <div class="form-group col-md-4">
      <input type="text" formControlName="nombre_convocatoria" class="form-control"
             placeholder="Nombre convocatoria" [class.is-invalid]="getNoValido('nombre_convocatoria')" />
      <small class="mensaje-error" *ngIf="getNoValido('nombre_convocatoria')">
        El campo nombre convocatoria es obligatorio.
      </small>
    </div>

    <div class="form-group col-md-2">
      <label class=" label">Estado convocatoria *</label>
    </div>

    <div class="form-group col-md-4">
      <select class="form-control" formControlName="estado_convocatoria"
              [class.is-invalid]="getNoValido('estado_convocatoria')">
        <option value="">Seleccione..</option>
        <option value="vigente">Vigente</option>
        <option value="no vigente">No vigente</option>
        <option value="activo">Activo</option>
        <option value="inactivo">incativo</option>

      </select>
    </div>


    <div class="form-group col-md-2">
      <label class=" label">Periodo convocatoria *</label>
    </div>

    <div class="form-group col-md-4">
      <select class="form-control" formControlName="periodo_convocatoria"
              [class.is-invalid]="getNoValido('periodo_convocatoria')">
        <option value="">Seleccione..</option>
        <option value="anual">Anual</option>
        <option value="semestral">Semestral</option>
        <option value="semanal">Semanal</option>
        <option value="continuo">Continuo</option>
        <option value="mensual">Mensual</option>
        <option value="bimensual">Bimensual</option>
        <option value="trimensual">Trimensual</option>
      </select>
    </div>


    <div class="form-group col-md-2">
      <label class="label "> Fecha inicio *</label>
    </div>

    <div class="form-group col-md-4">
      <input required readonly class="input input-date1" [matDatepicker]="fechaInicio"
             formControlName="fecha_inicio" (click)="fechaInicio.open()"
             [class.is-invalid]="getNoValido('fecha_inicio')" />
      <small class="mensaje-error" *ngIf="getNoValido('fecha_inicio')">
        El campo fecha inicio es obligatorio.
      </small>
      <mat-datepicker #fechaInicio></mat-datepicker>
    </div>



    <div class="form-group col-md-2">
      <label class="label "> Fecha final *</label>
    </div>

    <div class="form-group col-md-4">
      <input required readonly class="input input-date1" [matDatepicker]="fechaFinal"
             formControlName="fecha_final" (click)="fechaFinal.open()"
             [class.is-invalid]="getNoValido('fecha_final')" />
      <small class="mensaje-error" *ngIf="getNoValido('fecha_final')">
        El campo fecha final es obligatorio.
      </small>
      <mat-datepicker #fechaFinal></mat-datepicker>
    </div>


    <div class="form-group col-md-2">
      <label class="label "> Fecha suscripción *</label>
    </div>

    <div class="form-group col-md-4">
      <input required readonly class="input input-date1" [matDatepicker]="fechaSuscripcion"
             formControlName="fecha_suscripcion" (click)="fechaSuscripcion.open()"
             [class.is-invalid]="getNoValido('fecha_suscripcion')" />
      <small class="mensaje-error" *ngIf="getNoValido('fecha_suscripcion')">
        El campo fecha suscripción es obligatorio.
      </small>
      <mat-datepicker #fechaSuscripcion></mat-datepicker>
    </div>

    <div class="form-group col-md-2">
      <label  class="label "> Institución cooperante *</label>
    </div>

    <div class="form-group col-md-4">
      <select class="form-control" formControlName="nombre_institucion"
              [class.is-invalid]="getNoValido('nombre_institucion')">
        <option value="">Seleccione..</option>
        <option *ngFor="let institucionCooperante of institucionesCooperantes"  value="{{institucionCooperante._id}}"> {{institucionCooperante.nombre_institucion}}  </option>

      </select>

    </div>

    <div class="form-group col-md-2">
      <label class=" label">Tipo proyecto *</label>
    </div>

    <div class="form-group col-md-4">
      <input type="text" formControlName="tipo_proyecto" class="form-control"
             placeholder="Tipo proyecto" [class.is-invalid]="getNoValido('tipo_proyecto')" />
      <small class="mensaje-error" *ngIf="getNoValido('tipo_proyecto')">
        El campo nombre convocatoria es obligatorio.
      </small>
    </div>
 <!-- SELECT DE TIPO PROYECTO
    <div class="form-group col-md-4">
      <select class="form-control" formControlName="tipo_proyecto"
              [class.is-invalid]="getNoValido('tipo_proyecto')">
        <option value="">Seleccione..</option>
        <option *ngFor="let tipoProyecto of tiposProyecto"  value="{{tipoProyecto._id}}"> {{tipoProyecto.nombre_tipoProyecto}}  </option>
      </select>
    </div> !-->


    <div class="form-group col-md-2">
      <label  class="label ">Link inscripción *</label>
    </div>

    <div class="form-group col-md-4">
      <input type="text" class="form-control" formControlName="link_inscripcion" placeholder="Link inscripción"
             [class.is-invalid]="getNoValido('link_inscripcion')" />
      <small class="mensaje-error" *ngIf="getNoValido('link_inscripcion')">
        El campo link inscripción es obligatorio.
      </small>
    </div>

    <div class="form-group col-md-2">
      <label  class="label ">Codigo convocatoria</label>
    </div>

    <div class="form-group col-md-4">
      <input type="text" class="form-control" formControlName="codigo_conv" placeholder="Codigo Convocatoria"
             [class.is-invalid]="getNoValido('codigo_conv')" />
      <small class="mensaje-error" *ngIf="getNoValido('codigo_conv')">
        El campo codigo convocatoria es obligatorio.
      </small>
    </div>


    <div class="form-group col-md-6">
      <div class="row justify-content-end">

        <button class="submit" (click)="guardarFormulario()"> Crear </button>

      </div>
    </div>

    <div class="form-group col-md-6">
      <div class="row justify-content-start">

        <button class="submit" type=""> Cancelar </button>


      </div>
    </div>

  </form>

</section>


<section id="body">

  <div id="name">
    <h3> Criterios de consulta </h3>
  </div>

  <br />

  <form [formGroup]="formConsulta" class="row justify-content-center form">


    <div class=" form-group col-md-2 ">
      <label  class="label ">Número de convocatoria * </label>
    </div>

    <div class="form-group col-md-4">
      <input type="text" formControlName="_id" class="form-control" id="_id">

    </div>

    <div class="form-group col-md-2">
      <label for="institucionCooperante" class=" label ">Institución cooperante </label>
    </div>

    <div class="form-group col-md-4">
      <select class="form-control" id="institucionCooperante" placeholder="Institución cooperante" formControlName="nombre_institucion" >
        <option value="">Seleccione..</option>
        <option *ngFor="let institucionCooperante of institucionesCooperantes"  value="{{institucionCooperante._id}}">
          {{institucionCooperante.nombre_institucion}}
        </option>
      </select>

    </div>

    <div class="form-group col-md-2">
      <label  class=" label ">Estado convocatoria </label>
    </div>

    <div class="form-group col-md-4">
      <select class="form-control"  placeholder="Estado convocatoria" required formControlName="estado">
        <option value="">Seleccione..</option>
        <option value="vigente">Vigente</option>
        <option value="no vigente">No vigente</option>
        <option value="activo">Activo</option>
        <option value="inactivo">incativo</option>
      </select>

    </div>

    <div class="form-group col-md-2">
    </div>

    <div class="form-group col-md-4">
      </div>


    <div class="form-group col-md-6">
      <div class="row justify-content-end">

        <button class="submit" type="submit"  (click)="getConsulta()" > Consultar </button>
      </div>
    </div>

    <div class="form-group col-md-6">
      <div class="row justify-content-start">

        <button class="submit"  (click)="cancelarConsulta()"> Cancelar </button>


      </div>
    </div>



  </form>
</section>


<section id="body">

  <div id="name">
    <h3> Listado de convocatorias</h3>
  </div>

  <table class="table table-bordered">
    <thead>
    <tr>
      <th scope="col" class="center"> Id </th>
      <th scope="col" class="center"> Nombre convocatoria </th>
      <th scope="col" class="center"> Estado convocatoria </th>
      <th scope="col" class="center"> Institución cooperante </th>

      <th scope="col" class="center"> Acciones </th>
    </tr>
    </thead>
    <tbody>


    <tr *ngFor="let convocatoria of convocatorias">
      <td>{{convocatoria._id}}</td>
      <td>{{convocatoria.convocatoria.nombre_convocatoria}} </td>
      <td>{{convocatoria.convocatoria.estado_convocatoria}}</td>
      <td>{{convocatoria.InstitucionCooperante.nombre_institucion}}</td>
      <td>
        <button class="submit" (click)="visualizar(convocatoria._id)" >Ver</button>
        <button class="submit" (click)="editar(convocatoria._id)"  *ngIf="roles.includes(rol)" >Editar</button>
        <button class="submit" (click)="eliminarConvocatoria(convocatoria._id, convocatoria )" *ngIf="[1,5].includes(rol)" >Eliminar</button>
      </td>
    </tr>
    </tbody>
  </table>


</section>




</body>
